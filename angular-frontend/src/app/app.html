<div class="app-container" *ngIf="!loading; else loadingTpl">
  <!-- Sidebar (Visible only when logged in) -->
  <aside class="sidebar" *ngIf="isLoggedIn" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <div class="logo" *ngIf="!sidebarCollapsed">E-Com Docs</div>
      <div class="logo-icon" *ngIf="sidebarCollapsed">EC</div>
      <button class="btn-toggle" (click)="toggleSidebar()">
        <span *ngIf="!sidebarCollapsed">Â«</span>
        <span *ngIf="sidebarCollapsed">Â»</span>
      </button>
    </div>
    <nav class="sidebar-nav">
      <a routerLink="/products" routerLinkActive="active" class="nav-item">
        <i class="icon">ðŸ“¦</i> <span *ngIf="!sidebarCollapsed">Products</span>
      </a>
      <a routerLink="/customers" routerLinkActive="active" class="nav-item">
        <i class="icon">ðŸ‘¥</i> <span *ngIf="!sidebarCollapsed">Customers</span>
      </a>
      <a routerLink="/bills" routerLinkActive="active" class="nav-item">
        <i class="icon">ðŸ“„</i> <span *ngIf="!sidebarCollapsed">Bills</span>
      </a>
    </nav>
    <div class="sidebar-footer">
      <div class="user-info" *ngIf="!sidebarCollapsed">
        <span class="username">{{ userProfile?.username }}</span>
      </div>
      <button (click)="logout()" class="btn-logout" [title]="sidebarCollapsed ? 'Logout' : ''">
        <span *ngIf="sidebarCollapsed">ðŸšª</span>
        <span *ngIf="!sidebarCollapsed">Logout</span>
      </button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content" [class.full-width]="!isLoggedIn" [class.collapsed-sidebar]="sidebarCollapsed">
    <!-- Top Bar (Only for Guest or Mobile) -->
    <header class="top-bar" *ngIf="!isLoggedIn">
      <div class="logo">E-Com Portal</div>
      <div class="auth-buttons">
        <button (click)="login()" class="btn btn-primary">Login</button>
        <button (click)="register()" class="btn btn-secondary">Register</button>
      </div>
    </header>

    <div class="content-wrapper">
      <router-outlet></router-outlet>

      <!-- Guest Landing Page -->
      <div *ngIf="!isLoggedIn" class="landing-hero">
        <h1>Welcome to E-Com Microservices</h1>
        <p>Please login to manage products, customers, and bills.</p>
        <div class="hero-actions">
          <button (click)="login()" class="btn btn-large">Get Started</button>
        </div>
      </div>
    </div>
  </main>
</div>

<ng-template #loadingTpl>
  <div class="loading-screen">
    <div class="spinner"></div>
    <p>Loading Application...</p>
  </div>
</ng-template>